{% extends 'base.html' %}

{% block title %}My Company - Job Portal{% endblock %}

{% block content %}
{% if no_company %}
<div class="max-w-2xl mx-auto mt-10">
    <div class="text-center py-16 bg-card-light dark:bg-card-dark rounded-lg shadow-md">
        <span class="material-symbols-outlined text-6xl text-muted-light dark:text-muted-dark mb-4">domain_disabled</span>
        <h3 class="text-2xl font-bold text-foreground-light dark:text-foreground-dark">No Company Profile Found</h3>
        <p class="text-muted-light dark:text-muted-dark mt-2">You need to create a company profile before you can post jobs.</p>
        <a href="{% url 'companies:company_create' %}" class="mt-6 inline-block px-6 py-2 text-sm font-semibold rounded-lg bg-primary text-white hover:bg-primary/90 transition-colors">Create Company Profile</a>
    </div>
</div>
{% else %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Main Content -->
    <div class="lg:col-span-2 space-y-8">
        <!-- Company Profile Card -->
        <div class="bg-card-light dark:bg-card-dark rounded-lg shadow-md">
            <div class="p-6 border-b border-border-light dark:border-border-dark flex justify-between items-center">
                <h3 class="text-xl font-bold text-foreground-light dark:text-foreground-dark">Company Profile</h3>
                <a href="{% url 'companies:company_edit' company.id %}" class="px-4 py-2 text-sm font-semibold rounded-lg bg-primary/10 text-primary hover:bg-primary/20 transition-colors">Edit Company</a>
            </div>
            <div class="p-6">
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="md:w-1/3 flex-shrink-0">
                        {% if company.logo %}
                            <img src="{{ company.logo.url }}" class="w-full h-auto object-contain rounded-lg" alt="{{ company.name }} logo">
                        {% else %}
                            <div class="w-full aspect-square bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center">
                                <span class="material-symbols-outlined text-6xl text-gray-500">apartment</span>
                            </div>
                        {% endif %}
                    </div>
                    <div class="md:w-2/3">
                        <h4 class="text-2xl font-bold text-foreground-light dark:text-foreground-dark">{{ company.name }}</h4>
                        <p class="text-muted-light dark:text-muted-dark mt-1">{{ company.location }}</p>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4 text-sm">
                            <div>
                                <strong class="block text-foreground-light dark:text-foreground-dark">Email:</strong>
                                <a href="mailto:{{ company.contact_email }}" class="text-primary hover:underline truncate">{{ company.contact_email }}</a>
                            </div>
                            <div>
                                <strong class="block text-foreground-light dark:text-foreground-dark">Website:</strong>
                                {% if company.website %}
                                    <a href="{{ company.website }}" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline truncate">{{ company.website }}</a>
                                {% else %}
                                    <span class="text-muted-light dark:text-muted-dark">Not provided</span>
                                {% endif %}
                            </div>
                        </div>
                        
                        {% if company.description %}
                            <div class="mt-4">
                                <strong class="block text-sm text-foreground-light dark:text-foreground-dark">Description:</strong>
                                <div class="prose dark:prose-invert max-w-none text-sm mt-1">
                                    {{ company.description|linebreaks }}
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Job Postings -->
        <div class="bg-card-light dark:bg-card-dark rounded-lg shadow-md">
            <div class="p-6 border-b border-border-light dark:border-border-dark flex justify-between items-center">
                <h3 class="text-xl font-bold text-foreground-light dark:text-foreground-dark">Job Postings</h3>
                <a href="{% url 'jobs:job_create' %}" class="px-4 py-2 text-sm font-semibold rounded-lg bg-primary text-white hover:bg-primary/90 transition-colors">Post a Job</a>
            </div>
            <div class="p-6">
                {% if jobs %}
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {% for job in jobs %}
                            <div class="bg-background-light dark:bg-background-dark rounded-lg p-4 border border-border-light dark:border-border-dark">
                                <div class="flex justify-between items-start mb-2">
                                    <h4 class="font-bold text-foreground-light dark:text-foreground-dark">{{ job.title }}</h4>
                                    <span class="px-2 py-0.5 text-xs font-semibold rounded-full {% if job.is_active %}bg-green-100 text-green-800{% else %}bg-gray-200 text-gray-800{% endif %}">
                                        {% if job.is_active %}Active{% else %}Inactive{% endif %}
                                    </span>
                                </div>
                                <p class="text-sm text-muted-light dark:text-muted-dark flex items-center gap-1">
                                    <span class="material-symbols-outlined text-base">location_on</span>
                                    {{ job.location }}
                                </p>
                                <p class="text-xs text-muted-light dark:text-muted-dark mt-2">
                                    {{ job.get_job_type_display }} &bull; Posted {{ job.posted_date|timesince }} ago
                                </p>
                                <div class="flex justify-between items-center mt-4">
                                    <a href="{% url 'jobs:job_detail' job.slug %}" class="text-sm font-semibold text-primary hover:underline">View Job</a>
                                    <p class="text-sm text-muted-light dark:text-muted-dark flex items-center gap-1">
                                        <span class="material-symbols-outlined text-base">group</span>
                                        {{ job.get_application_count }}
                                    </p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-8">
                        <p class="text-muted-light dark:text-muted-dark">No jobs posted yet.</p>
                        <a href="{% url 'jobs:job_create' %}" class="mt-4 inline-block px-6 py-2 text-sm font-semibold rounded-lg bg-primary text-white hover:bg-primary/90 transition-colors">Post Your First Job</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Sidebar -->
    <div class="lg:col-span-1 space-y-6">
        <div class="bg-card-light dark:bg-card-dark rounded-lg shadow-md p-6">
            <h4 class="text-lg font-bold text-foreground-light dark:text-foreground-dark mb-4">Quick Stats</h4>
            <ul class="space-y-3 text-foreground-light dark:text-foreground-dark">
                <li class="flex items-center gap-3"><span class="material-symbols-outlined text-xl text-muted-light dark:text-muted-dark">work</span> {{ total_jobs_count }} Total Jobs</li>
                <li class="flex items-center gap-3"><span class="material-symbols-outlined text-xl text-muted-light dark:text-muted-dark">task_alt</span> {{ active_jobs_count }} Active Jobs</li>
                <li class="flex items-center gap-3"><span class="material-symbols-outlined text-xl text-muted-light dark:text-muted-dark">group</span> {{ total_applications_count }} Total Applications</li>
            </ul>
        </div>
        
        <div class="bg-card-light dark:bg-card-dark rounded-lg shadow-md p-6">
            <h4 class="text-lg font-bold text-foreground-light dark:text-foreground-dark mb-4">Quick Actions</h4>
            <div class="flex flex-col gap-3">
                <a href="{% url 'jobs:job_create' %}" class="w-full text-center px-4 py-2 text-sm font-semibold rounded-lg bg-primary text-white hover:bg-primary/90 transition-colors">Post a Job</a>
                <a href="{% url 'jobs:my_jobs' %}" class="w-full text-center px-4 py-2 text-sm font-semibold rounded-lg bg-primary/10 text-primary hover:bg-primary/20 transition-colors">Manage Jobs</a>
                <a href="{% url 'applications:application_list' %}" class="w-full text-center px-4 py-2 text-sm font-semibold rounded-lg bg-primary/10 text-primary hover:bg-primary/20 transition-colors">View Applications</a>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

